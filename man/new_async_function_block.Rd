% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/async_function_block.R
\name{new_async_function_block}
\alias{new_async_function_block}
\title{Async Function Block}
\usage{
new_async_function_block(
  fn = "function(data, n = 6L) { Sys.sleep(2); utils::head(data, n) }",
  ...
)
}
\arguments{
\item{fn}{Character string containing R function code that transforms a data
frame. The function must have \code{data} as first argument. Default values of
other arguments determine the UI widgets.}

\item{...}{Additional arguments passed to new_block}
}
\description{
A block that wraps a user-defined R function and executes it asynchronously
using mirai + ExtendedTask. Unlike \code{new_function_block()}, this block requires
manual execution via a "Run" button and supports cancellation.
}
\section{Approach}{

The function must have \code{data} as its first argument (the input data frame).
Additional arguments are introspected and UI is generated based on defaults:
\itemize{
\item Character vector with multiple elements -> selectInput (dropdown)
\item Single numeric value -> numericInput
\item Single logical value -> checkboxInput
\item Single character value -> textInput
}
}

\section{Output Types}{

Output type is auto-detected from the function's return value (in priority order):
\itemize{
\item \code{gt_tbl}: renders as GT HTML table
\item \code{ggplot}: renders with plotOutput/renderPlot
\item \code{recordedplot} (base R plot): renders with evaluate::replay() in renderPlot
\item \code{data.frame}/\code{tibble}: renders as interactive DataTable
\item Any other object: shows print() output as preformatted text
}
}

\section{Async Execution}{

\itemize{
\item Click "Run" to execute the function in a background mirai daemon
\item Click "Cancel" to stop a running computation
\item Status indicators show initial/running/completed/error states
\item Requires \code{mirai::daemons()} to be set up before use
}
}

\examples{
\dontrun{
# Setup daemons first
mirai::daemons(2)
shiny::onStop(function() mirai::daemons(0))

# Create an async block with simulated slow computation
blk <- new_async_function_block(
  fn = "function(data, n = 6L) {
    Sys.sleep(2)  # Simulate slow computation
    utils::head(data, n)
  }"
)
}

}
